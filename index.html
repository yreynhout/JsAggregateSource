<html>
<head>
<script src="scripts/json2.min.js"></script>
<script src="scripts/store.min.js"></script>
<script src="scripts/aggregatesource.js"></script>
<script src="scripts/model.js"></script>
<script>
if (!store.enabled) {
	console.error("Local storage is not supported by your browsa - No demo for you.");
} else {
	var original = new Model.InventoryItem('item/1', 'Boxer shorts');
	original.checkIn(5);
	original.checkIn(2);
	original.deactivate();
	var changes1 = original.getChanges();
	for(var index = 0, length = changes1.length; index < length; index++) {
		console.info(JSON.stringify(changes1[index]));
	}
	store.set('item/1', changes1);

	var loaded = new Model.PrivateInventoryItemConstructor();
	loaded.initialize(store.get('item/1'));
	try {
		loaded.deactivate();
	} catch(error) {
		console.info('Oops:' + error.message);
	}
	var changes2 = loaded.getChanges();
	for(var index = 0, length = changes2.length; index < length; index++) {
		console.info(JSON.stringify(changes2[index]));
	}
}
</script>
</head>
<body></body>
</html>